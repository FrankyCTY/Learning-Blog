<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- google fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins&display=swap"
      rel="stylesheet"
    />

    <!-- Font awesome  -->
    <link
      rel="stylesheet"
      href="https:+//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css"
      integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ="
      crossorigin="anonymous"
    />

    <!-- iconfont -->
    <link
      rel="stylesheet"
      href="//at.alicdn.com/t/font_1791755_n1rvnnmldp.css"
    />

    <!-- css -->
    <link rel="stylesheet" href="../../SCSS/mix.css" />

    <title>firestore - database</title>
  </head>
  <body>
    <div class="menu">
      <span>menu</span>
    </div>
    <header class="header">
      <nav>
        <ul class="nav-list">
          <li><a href="../../tableOfContent.html">Javascript</a></li>
          <li><a href="../../tableReact.html">React</a></li>
          <li><a href="../../tableFirebase.html">Firebase</a></li>
        </ul>
      </nav>
    </header>

    <main class="main">
      <h1 class="page-title">
        firestore - database
      </h1>

      <p class="clr-bad">
        Workflow -> userObj -> queryReference obj -> snapshot obj
      </p>

      <h3>How to get data from firestore?</h3>

      <img
        style="width: 60%; display: block;"
        src="../../img/firebase/firestore/firestore.PNG"
        alt=""
      />

      <p>
        FireStore data is stored in a structure consisted with collection and
        document (just like record).
      </p>

      <img
        style="width: 40%;"
        src="../../img/firebase/firestore/get fireStore data.PNG"
        alt=""
      />
      <img
        style="width: 40%;"
        src="../../img/firebase/firestore/authStateChanged.PNG"
        alt=""
      />

      <p class="clr-good">How to get data from firestore</p>
      <p>
        <span style="color: steelblue;">1. firestore.doc() </span>
        <span class="clr-bad"
          >since we are getting the document from the firestore (middle column
          in the first image)</span
        >
      </p>

      <p>
        <span style="color: steelblue;">2. userAuth </span>->
        <span class="clr-bad">userAuth is my custom variable</span> which
        <span class="clr-good"
          >contains the user obj that we get from
          <span class="clr-bad">onAuthStateChanged().</span></span
        >
        (image 2)
      </p>

      <p>
        <span style="color: steelblue;">3. userAuth.uid </span>->
        <span class="clr-bad">uid is the unique identifier</span> that
        <span class="clr-bad">resides in the user obj.</span>
      </p>

      <img
        style="width: 40%;"
        src="../../img/firebase/firestore/user obj.PNG"
        alt=""
      />
      <img
        style="width: 35%;"
        src="../img/firebase/firestore/queryReference.PNG"
        alt=""
      />
      <p style="color: orangered; text-decoration: underline;">
        <strong
          >userRef will be returned even though the target resource doesn't
          exist. > >Detail data for the resource is captured by using CRUD
          operation that will return a snapshot obj.</strong
        >
      </p>
      <p>
        <span style="color: steelblue;">4. userRef </span>-> Querying the
        firestore will
        <span class="clr-bad">return a documentReference obj</span>
        that also inclues that data of the parent. (CollectionReference: user
        (in this case))
      </p>

      <p style="color: orangered; text-decoration: underline;">
        <strong>
          DocumentReference Obj allows us to perform CRUD operation to the
          firestore database using get(), set() etc.</strong
        >
      </p>

      <span style="color: steelblue;">5. snapshot </span>-> It
      <span class="clr-bad"
        >returned by the CRUD operation to the DocumentReference obj.</span
      >
      <span styke="color: orangered"
        >It includes the data of the target resource.</span
      >

      <img
        style="width: 30%; display: block;"
        src="../../img/firebase/firestore/snapshot.PNG"
        alt=""
      />

      <h3 style="margin-top: 4em;">How to set data?</h3>
      <p>
        We create a function in firebase module to set firestore's user data.
      </p>

      <img
        style="width: 40%;"
        src="../../img/firebase/firestore/set data.PNG"
        alt=""
      />
      <img
        style="width: 40%;"
        src="../../img/firebase/firestore/createUserProfile.PNG"
        alt=""
      />

      <p style="color: orangered; text-decoration: underline;">
        <strong
          >CRUD operation needed to perform with async await (userRef.get()
          set())</strong
        >
      </p>

      <p>
        <span style="color: steelblue;">Left: </span>We create a
        <span class="clr-bad">function in firebase module </span>to
        <span class="clr-bad">set firestore's user data.</span>
      </p>
      <p>
        <span style="color: steelblue;">Right: </span>
        <span class="clr-good">userAuth obj </span>will be passed to the
        function as the <span class="clr-good">argument 'userAuth',</span> and
        the <span class="clr-bad">additionalData is not yet defined here.</span>
      </p>

      <p>
        <span style="color: steelblue;">1. If the userAuth is undefuned </span
        >-> <span class="clr-bad">return,</span> since we have nothing to set in
        firestore.
      </p>
      <p>
        <span style="color: steelblue;">2.If snapShot is not exist </span>->
        then we <span class="clr-good">create profile in the firestore.</span>
      </p>
    </main>

    <script src="../../app.js"></script>
  </body>
</html>
